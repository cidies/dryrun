{% extends 'base.html' %}

{% block content %}
<h2>Kommunikation</h2>
<div class="chat">
    <h3>Team-Chat</h3>
    <div id="chat-window" style="border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px;">
        <!-- Chat-Nachrichten werden hier angezeigt -->
    </div>
    <input type="text" id="chat-input" placeholder="Nachricht eingeben">
    <button id="send-button">Senden</button>
</div>
<div class="video-calls">
    <h3>Video-Calls</h3>
    <button>Meeting starten</button>
    <button>Meeting beitreten</button>
</div>
<div class="forums">
    <h3>Foren</h3>
    <div id="forum">
        <p><strong>Thema:</strong> Neue Bedrohungen</p>
        <p>Beitrag: Analyse der neuesten Ransomware-Varianten</p>
        <p>Beitrag: Strategien zur Verhinderung von DDoS-Angriffen</p>
    </div>
</div>

<script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const socket = io.connect('http://' + document.domain + ':' + location.port + '/chat');
        const chatWindow = document.getElementById('chat-window');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        
        // Generiere zufÃ¤llige ID
        const userId = 'user' + Math.floor(Math.random() * 10000);
        
        // Empfangene Nachrichten anzeigen
        socket.on('message', function(data) {
            const messageElement = document.createElement('div');
            messageElement.textContent = data.user + ': ' + data.message;
            chatWindow.appendChild(messageElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        });
        
        // Nachricht senden
        sendButton.addEventListener('click', () => {
            const message = chatInput.value;
            socket.emit('send_message', {user: userId, message: message});
            chatInput.value = '';
        });
        
        // Senden bei Enter-Taste
        chatInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                sendButton.click();
            }
        });
    });
</script>
{% endblock %}
